
public static List<Map<String, String>> extractLoop(String loopName, List<Map<String, String>> parsedData) {
    List<Map<String, String>> result = new ArrayList<>();

    parsedData.forEach(map -> {
        // Temporary grouping by index
        Map<String, Map<String, String>> groupedByIndex = new LinkedHashMap<>();

        map.forEach((key, value) -> {
            if (key.contains(loopName + "[")) {
                // Extract index e.g. Loop-2420[0]
                String indexPart = key.substring(key.indexOf(loopName + "[") + loopName.length());
                String index = indexPart.substring(1, indexPart.indexOf("]")); // get '0' from '[0]'
                String cleanedKey = key.substring(key.indexOf("]") + 2); // remove Loop-XXXX[0].

                groupedByIndex
                        .computeIfAbsent(index, k -> new LinkedHashMap<>())
                        .put(cleanedKey, value);
            }
        });

        result.addAll(groupedByIndex.values());
    });

    return result;
}
